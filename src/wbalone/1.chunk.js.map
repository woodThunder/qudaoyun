{"version":3,"sources":["webpack:///./src/js/ext/sidebar.js"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,wCAAwC;AACzE;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAAyC,sBAAsB;AAC/D,iDAAgD,8BAA8B;AAC9E;AACA;AACA,0CAAyC,0GAA0G;AACnJ;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;AACA,eAAc;AACd;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,IAAI,GAAG,EAAE,MAAM,IAAI;AAClD;AACA;AACA,2CAA0C,KAAK;AAC/C,8BAA6B,IAAI;AACjC,gCAA+B,IAAI;AACnC;AACA,2CAA0C;AAC1C;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0FAAyF;AACzF;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qFAAoF;AACpF;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA,2DAA0D;AAC1D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB,mDAAmD;AACpE;AACA;AACA,kBAAiB;AACjB;AACA;AACA,0EAAyE;AACzE;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAC","file":"1.chunk.js","sourcesContent":["/**\n * Created by chief on 16/5/18.\n */\n\ndefine(\"sidebar\",[],function(){\n    var sidebar = function (container){\n        this.container = $(container) || $(\"body\");\n        this.parent = this.container.closest('.site-menubar');\n        this.num = 0;\n        this.curNum = 0;\n        this.initMenuList();\n    };\n    sidebar.prototype = {\n        scroll:function(){\n            var _this = this;\n            var html = '<div class=\"menubar-footer\">'+\n                '<a style=\"cursor: pointer\" title=\"通过滚动鼠标来移动菜单\" class=\"arrow-up lock\"><i class=\"portalfont icon-arrow-up\"></i></a>'+\n                '<a style=\"cursor: pointer\" title=\"通过滚动鼠标来移动菜单\" class=\"arrow-down\"><i class=\"portalfont icon-arrow-down\"></i></a>'+\n                '</div>';\n            this.container.parent().append($(html));\n            if(getBrowserVersion()=='IE8'){\n                this.parent.css({'visibility':'hidden','display':'block'});\n            }\n            var cH = document.body.scrollHeight-50-10;\n            var sH = this.container.height();\n            //var menu = this.container.find('.menubar').parent();\n\n            if(sH>cH){\n                this.parent.find('.menubar-footer').show();\n            }\n\n            if(getBrowserVersion()=='IE8'){\n                this.parent.removeAttr('style');\n            }\n\n            function scroll(value){\n                var h  = document.body.clientHeight-50-10;\n                var showNum = parseInt(h/70);\n\n                _this.curNum = _this.curNum+value;\n                if(_this.curNum<0){\n                    _this.curNum = 0;\n                    _this.parent.find('.arrow-up').addClass('lock')\n                    return false;\n                }\n                //fix: add 1 fake element\n                else if(_this.curNum>_this.num-showNum+2) {\n                    _this.curNum=_this.num-showNum+2;\n                    _this.parent.find('.arrow-down').addClass('lock')\n                    return false;\n                }\n                else {\n                    _this.parent.find('.arrow-down,.arrow-up').removeClass('lock');\n                }\n\n                if(getBrowserVersion()=='IE8'||getBrowserVersion()=='IE9'){\n                    _this.container.css({'position':'absolute'});\n                    $(_this.container).animate({'top':(-_this.curNum*70)+'px'},'300','swing')\n                }\n                else {\n                    _this.container.css({'transform':'translateY('+(-_this.curNum*70)+'px)','-ms-transform':'translateY('+(-_this.curNum*70)+'px)'});\n                }\n            }\n            this.parent.find('.arrow-up,.arrow-down').on('click',function(){\n                var value = $(this).hasClass(\"arrow-down\")?1:-1;\n                scroll(value)\n            })\n            /* //-- on arrow hover --//\n             var arrowTimmer ;\n             this.parent.find('.arrow-up,.arrow-down').on('mouseover',function(){\n             var value = $(this).hasClass(\"arrow-down\")?1:-1;\n             if(arrowTimmer){\n             clearInterval(arrowTimmer);\n             arrowTimmer = null;\n             }\n             var timmer = (function(fx){\n             return function(){\n             scroll(fx);\n             }\n             })(value);\n             arrowTimmer = setInterval(timmer, 500);\n             }).on('mouseout',function(){\n             if(arrowTimmer){\n             clearInterval(arrowTimmer);\n             arrowTimmer = null;\n             }\n             })\n             //-- on arrow hover --//*/\n            _this.container.on('mousewheel',function(event,delta) {\n                var value = delta>0?-1:1; //fix: window mousewheel style\n                scroll(value);\n                event.stopPropagation();\n                event.preventDefault();\n            });\n            //ipad 滚动\n            if(navigator.userAgent.indexOf(\"iPad\")!=-1){\n                _this.container.on('touchstart',function(event) {\n                    startY = event.originalEvent.changedTouches[0].pageY;\n                });\n                _this.container.on('touchmove',function(event) {\n                    moveEndY = event.originalEvent.changedTouches[0].pageY;\n                    var y = moveEndY - startY;\n                    var value = y <= 0?1:-1;\n                    scroll(value);\n                    event.stopPropagation();\n                    event.preventDefault();\n                });\n            }\n        },\n        html:function(data){\n            //data = data.slice(0,4);\n            var str = [];\n            var hash = location.hash;\n            var _this = this;\n            var menubar = this.container;\n            this.num = data.length;\n            function formmaterUrl(item) {\n                var uri = \" \";\n                if (item.urltype === 'url') {\n                    var target=item.openview==\"blank\"?\"_blank\":\"\";\n                    if(target){\n                        //uri = '#/ifrNoHead/' + encodeURIComponent(encodeURIComponent(item.location));\n                        uri = item.location;\n                    }else{\n                        uri = '#/ifr/' + encodeURIComponent(encodeURIComponent(item.location));\n                    }\n                    return  uri;\n                } else if (item.urltype === 'plugin') {\n                    uri = item.id ? ('#/' + item.id) : \"#/index_plugin\";\n                    registerRouter(uri.replace(\"#\", \"\"), item.location);\n                    return  uri;\n                } else if (item.urltype === 'view') {\n                    uri = item.location;\n                    return  \"#/sidebar/\"+uri;\n                }else if(item.urltype == undefined){\n                    item.location = '404';\n                    return  '#/ifr/' + encodeURIComponent(encodeURIComponent(item.location));\n                }\n                else {\n                    return item.location;\n                }\n            }\n            function IsURL(str_url) {\n                var strRegex = '^((https|http|ftp|rtsp|mms)?://)'\n                    + '?(([0-9a-z_!~*\\'().&=+$%-]+: )?[0-9a-z_!~*\\'().&=+$%-]+@)?' // ftp的user@\n                    + '(([0-9]{1,3}.){3}[0-9]{1,3}' // IP形式的URL- 199.194.52.184\n                    + '|' // 允许IP和DOMAIN（域名）\n                    + '([0-9a-z_!~*\\'()-]+.)*' // 域名- www.\n                    + '([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].' // 二级域名\n                    + '[a-z]{2,6})' // first level domain- .com or .museum\n                    + '(:[0-9]{1,4})?' // 端口- :80\n                    + '((/?)|' // a slash isn't required if there is no file name\n                    + '(/[0-9a-z_!~*\\'().;?:@&=+$,%#-]+)+/?)$';\n                var re = new RegExp(strRegex);\n                if (re.test(str_url)) {\n                    return true;\n                } else {\n                    return false;\n                }\n            };\n\n            if(hash.match(/#\\/widget|#\\/layouts/)){\n                if(hash.match(/#\\/widget|#\\/layouts/).length>0){\n                    $(\"#design\").attr(\"sortalbe\",'false').parent().hide();\n                    $(\"#design\").parent().parent().find('.divider').hide();\n                }\n            }\n\n            $.each(data, function (i, item) {\n                if (item.children != null && (item.children) && (item.children.length)) { //child menu\n                    var s = '<div class=\"menubar-menu '+(item.children.length>=10?\"menubar-cloum-\"+parseInt(item.children.length/10):\"\")+'\"><ul>';\n                    $.each(item.children, function (t, items) {\n                        var target=items.openview==\"blank\"?\"_blank\":\"\";\n                        s += '<li><a target=\"'+target+'\" urltype=\"' + (items.urltype ) + '\" ahref=\"' + items.location + '\" href=\"' + (formmaterUrl(items)) + '\">' + items.name + '</a></li>';\n                    });\n                    s += '</ul></div>';\n                    var b = '<span class=\"icon wb-chevron-right-mini\"></span>';\n                    var t = '';\n                    str.push(\n                        '<li ' + (i == 0 ? 'class=\"active\" isIndex=\"true\"' : \"\") + '>' +\n                        '<a urltype=\"' + item.urltype + '\" href=\"javascript:void(0);\" >' +\n                        '<i class=\"icon   '+ item.icon+'\"> </i>' + '<span class=\"icon-name\">' + item.name + b + '</span>'+\n                        '</a>' + t + s +\n                        '</li>')\n                } else {\n                    var s = '', b = '';\n                    var target=item.openview==\"blank\"?\"_blank\":\"\";\n                    str.push(\n                        '<li ' + (i == 0 ? 'class=\"active\" isIndex=\"true\"' : \"\") + '>' +\n                        '<a target=\"'+target+'\" urltype=\"' + item.urltype + '\" ahref=\"#' + item.location + '\" href=\"' + formmaterUrl(item) + '\">' +\n                        '<i class=\"icon  '+ item.icon+'\"></i>' + '<span class=\"icon-name\">' + item.name + '</span>' + b +\n                        '</a>'  + s +\n                        '</li>');\n\n                }\n            });\n\n            menubar.html(str.join(''));\n            this.scroll();\n            return this;\n        },\n        init:function(){\n            var _this = this;\n            var menubar = this.container;\n            var clickEventType=((document.ontouchstart!==null)?'click':'touchend');\n\n            menubar.on(clickEventType, 'li',function (e) {   //菜单点击\n                var li = $(e.target).closest('.menubar-menu').length>0?$(this).closest('.menubar-menu').closest('li'):$(this).closest('li');\n                if(li.hasClass('active')){\n                    var target = $(e.target).closest('a');\n                    var path = target.attr(\"href\");\n                    var ismenu = $(this).find('.menubar-menu').length>0;\n\n                    //刷新path\n                    if(path.search(/^javascript\\:/ig)==-1&&location.hash==path){\n                        path = path.replace('#','');\n                        router.dispatch('on',path);\n                    }\n\n                    //initLayout(contextRoot+'/data:layout' + href.replace('#','')+\"?r=\"+Math.random(),[]);\n                }\n                _this.container.find('li').removeAttr('class');\n                $(this).addClass('active');\n            });\n            if(navigator.userAgent.indexOf(\"iPad\")==-1){\n                menubar.on('mouseenter', 'li',function (e) {\n                    var menu = $(this).find('.menubar-menu');\n                    var tips = $(this).find('.tips');\n                    var top = _this.container.position().top;\n                    var menuTop = $(this).position().top;\n                    var scroll=$(window).height()-$(this).offset().top;\n                    if(scroll<menu.height()){\n                        menu.css('bottom','0').css('top','auto');\n                    }\n                    menu.show();\n                    tips.show();\n                    $(this).addClass('menubar-hover');\n                }).on('mouseleave', 'li',function (e) {\n                    var menu = $(this).find('.menubar-menu');\n                    var tips = $(this).find('.tips');\n                    menu.hide();\n                    tips.hide();\n                    $(this).removeClass('menubar-hover');\n                }).on('mouseleave',function (e) {\n                    var tips = $(this).find('.tips');\n                    tips.hide();\n                }).on('click', '.menubar-menu ul>li', function (e) { //子菜单点击处理\n                    $(this).siblings(\"li\").removeClass(\"active\").end().addClass('active').parents(\"li:first\").addClass(\"active\");\n                    $(this).closest('.menubar-menu').hide();\n                });\n            }\n            else {\n                menubar.on('click', '.menubar-menu ul>li', function (e) { //子菜单点击处理\n                    $(this).siblings(\"li\").removeClass(\"active\").end().addClass('active').parents(\"li:first\").addClass(\"active\");\n                    $(this).closest('.menubar-menu').hide();\n                }).on('mousedown', 'li',function (e) {\n                    var menu = $(this).find('.menubar-menu');\n\n                    var top = _this.container.position().top;\n                    var menuTop = $(this).position().top;\n                    var scroll=$(window).height()-$(this).offset().top;\n                    if(scroll<menu.height()){\n                        menu.css('bottom','0').css('top','auto');\n                    }\n                    menu.show();\n                }).on('mouseleave','li',function (e) {\n                    var menu = $(this).find('.menubar-menu');\n                    menu.hide();\n                })\n\n            }\n            //设定hash的选中状态\n            var hash = encodeURI(location.hash);\n            var element  = _this.container.find('a[href~=\"'+hash+'\"]');\n            if(element.length>0){\n                var parent = element.closest('.menubar-menu');\n                _this.container.find('li:first-child').removeClass('active');\n                if(parent.length>0){\n                    parent.closest('.menubar-menu').parent().addClass(\"active\");\n                }\n                element.parent().addClass(\"active\");\n            }\n\n            return this;\n        },\n        initMenuList:function(){\n            var _this = this;\n            $.ptAjax({\n                url: contextRoot + \"/appmenumgr/sidebarList?r=\"+Math.random(),\n                type: 'GET',\n                dataType: 'json',\n                async: false,\n                contentType: 'application/json',\n                success: function (result) {\n                    if (result.status) {\n                        _this.html(result.data);\n                        _this.init();\n                        _this.router();\n                    } else {\n                        console.log(result.msg ? result.msg : \"error happend!~!\");\n                    }\n                },\n                error: function (XMLHttpRequest) {\n                    errorLogin(XMLHttpRequest);\n                    alert(\"网络请求失败\");\n                }\n            });\n\n            return this;\n        },\n        router:function(){\n            var homePage = this.container.find(\"li[isindex=true]>a\").attr(\"href\");\n            if(window.extendRouteRegister){\n                window.extendRouteRegister(router);\n            }\n            if($.trim(window.location.hash)==''){\n                router.init(homePage.replace(\"#\",\"\"));\n            }else{\n                router.init(\"/\"+window.location.hash);\n            }\n            return this;\n        }\n    };\n\n    return sidebar\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/ext/sidebar.js\n ** module id = 36\n ** module chunks = 1\n **/"],"sourceRoot":""}